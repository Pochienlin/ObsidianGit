# Kidney Exchange
UID: 202204122104
Tags: #üå± 
Links: [[Strategic Thinking]]

-----

## 0. Overview
#### Axioms
| Axiom                 | Description                                                                                                                                                                     |
| --------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Pareto Efficient      | There is no other matching that makes no agents worse off and some agents better off                                                                                            |
| Strategy-proof        | No agents stands to gain a better outcome by misreporting preferences, regardless of other agents' reporting. i.e., Honest reporting is weakly better than fraudulent reporting |
| Individually rational | No agents get an option worse off than what they originally have                                                                                                                |
The Top Trading Cycle mechamism is the only mechanism that satisfies all 3 axioms

A mechanism takes fixed objects, agents and ownership model, and only takes as a variable the preference orderings of agents to recommend a matching. This is different from a voting rule, where any number of voters, candidates and preference orderings are all taken in as inputs.

## I. Kidney exchange problem

Market cannot make supply meet demand (vice versa) due to 2 constraints

‚ùå¬†**Constraint 1: Medical**

- Living/deceased donor has to be medically compatible (e.g. blood type) with living patient

‚ùå¬†**Constraint 2: Institutional (ethical)**

- Organ cannot be treated as commodities due to ethical issues
- Illegal for monetary benefits to be derived from kidney transfers

<aside>
üí° Central problem: how to realise free-market outcomes in exchanges without the use of money? (solution: TTC mechanism)

</aside>

Well-defined allocations problem:

- **Agents** (e.g. students, kidney patient) ‚Üí fixed at $N$ agents
- **Objects** (being claimed, e.g. dormitories, kidney donor) ‚Üí fixed at $N$ objects
- **Ownership** (e.g. each student lives in a dormitory) ‚Üí fixed ownership structure
- **Preferences** (e.g. each agent has a preference ordering over all houses) ‚Üí private info

Assumption: same number of agents and objects

Matching specifies who gets what ‚Üí through a mechanism

### Formal definition of mechanism

- A *mechanism* is a function that assigns to every preference profile a matching (i.e. "matching rule")
    - Preference profile: list of all agents' preference rankings

‚ùó NOT a rule (e.g. voting, division) as agents, objects, and ownership structure are fixed (mechanism depends on each number of agents and objects) ‚Üí mechanism is a "restricted rule")

## II. Top trading cycles (TTC) algorithm

**STEP 1**: each agent points to their most preferred object

- Draw an arrow to indicate agent's favourite object

**STEP 2**: select a cycle and have those agents trade objects; these agents leave the market after trading

- e.g. Agent A ‚Üí Object B and Agent B ‚Üí Object A: Agent A and B leave the market

**STEP 3**: Repeat STEP 2 until all agents leave the market

- i.e. agent points to their preferred object that is still on the market ‚Üí select a cycle to trade ‚Üí agents leave the market after trading
- Market is cleared in STEP 3

**NOTE**

- There may be **multi-agent cycle** (multiple agents exchange at one go, e.g. A‚ÜíB, B‚ÜíC, C‚ÜíA) but principle that every one has their favourite object available on the market remains
- There may be a **trivial case** (e.g. agent selects own object) ‚Üí trivial cycle (no trade involved and agent leaves the market)

![Each node is both an agent and the object; each arrow indicates the favourite object of the agent](Po/04%20Kidney%20%2078c1a/Untitled.png)

Each node is both an agent and the object; each arrow indicates the favourite object of the agent

### TTC algorithm is well-defined

Each node has one outgoing arrow ‚Üí there exists at least one cycle

Each node has only one outgoing arrow ‚Üí cycles do not conflict

**TTC algorithm:**

- Will never end up with no cycle (s26)
- Does not depend on the sequence of exchanges, if there are multiple cycles (s27)
- Will never end up with 2 cycles sharing a common node (s28)
- Will never end up with 2 cycles sharing a common link (s29)

![Untitled](Po/04%20Kidney%20%2078c1a/Untitled%201.png)

- **Agent**: $a_1,a_2,a_3,a_4,a_5$
- **Object**: $h_1,h_2,h_3,h_4,h_5$
- **Initial ownership structure**: indicated by subscript $a_i$ (i.e. $a_1$ owns $h_1$)

TTC on s31

1. $a_2‚Üíh_5,a_5‚Üíh_2$
2. $a_1‚Üíh_1$
3. $a_3‚Üíh_4,a_4‚Üíh_3$

![Untitled](Po/04%20Kidney%20%2078c1a/Untitled%202.png)

***TTC mechanism***: function that chooses for each preference profile the matching generated by the TTC algorithm (outcome: TTC matching)

## III. SP, PE and IR of TTC

> Theorem (Ma, 1994): A mechanism is (1) strategy-proof, (2) Pareto efficient, and (3) individually rational if and only if it is the TTC mechanism
> 

‚ùå  only if: derivation is out of syllabus (only need to know why TTC mechanism is SP, PE and IR)

### Strategy-proofness and TTC

<aside>
üí° TTC mechanism incentivises all agents to reveal true preferences

</aside>

(agent cannot be assigned a better object by lying about preference, regardless of other agents' preferences)

Agent $i$ must leave in $n$-th round of the TTC algorithm

- if $n=1$, agent $i$ gets favourite object and exits the market ‚Üí cannot get a better object by lying
- if $n>1$, agent $i$ gets an object belonging to some agent who remains on the market in the $n$-th round
    - even if agent $i$ lies, agent $i$ cannot receive any object that has already been allocated and exited from the market
    - if agent $i$ tells the truth, agent $i$ gets favourite object remaining on the market

THEREFORE agent $i$ cannot get a better object by lying

### Pareto efficiency and TTC

<aside>
üí° TTC mechanism is socially-desirable (not just individual who is well off) ‚Üí not Pareto efficient if there is a more efficient method (better allocation)

</aside>

- **Pareto efficient matching**: no other matching that makes no agent worse off and some agent (strictly) better off
- **Pareto efficient mechanism**: chooses for each preference profile a **Pareto efficient matching** (demanding requirement)

Example for illustration

![Untitled](Po/04%20Kidney%20%2078c1a/Untitled%203.png)

‚≠ê Proof that TTC is Pareto efficient

1. $a_2‚Üíh_5,a_5‚Üíh_2$
    - $a_2$ and $a_5$ cannot be made any better off
2. $a_1‚Üíh_1$
    - $a_1$ can be made better off ($h_5$ or $h_2$), BUT doing so would make $a_2$ or $a_5$ worse off
3. $a_3‚Üíh_4,a_4‚Üíh_3$
    - $a_3$ cannot be made any better off
    - $a_4$ can be made better off ($h_2$, $h_1$ or $h_5$), BUT doing so would make $a_2$, $a_5$ or $a_1$ worse off

![Untitled](Po/04%20Kidney%20%2078c1a/Untitled%204.png)

‚ùó TTC is NOT the ONLY Pareto efficient (an alternative PE mechanism exists)

- if best houses are assigned to $a_1,a_3,a_4$ (for the sake of argument, not for $a_2,a_5$ who are first cycle top choices)
- $a_2‚Üíh_3$, $a_5‚Üíh_1$

**Blue** is also a PE outcome (but we cannot have a uniform comparison between **Blue** and TTC to determine which is better)

PRECISE ARGUMENT (s42-45) not required in final exam

### Individual rationality and TTC

(similar to *participation* in the voting context)

<aside>
üí° TTC mechanism does not make anyone worse off by participating in the mechanism

</aside>

- **Individually rational matching**: each agent gets an object that is no worse than own object (i.e. for $a_1$, $h_i‚â•h_1$, where $h_i$ is the allocated object)
- **Individually rational mechanism**: chooses for each preference profile an **Individually rational matching** (demanding requirement)

![Untitled](Po/04%20Kidney%20%2078c1a/Untitled%205.png)

- Orange circle: own object
- Yellow highlight: TTC allocation

‚≠ê Regardless of which round the agent leaves the market, the agent gets the best object among the remaining objects in the market, including their own object

‚ÄºÔ∏è $a_i‚Üíh_i$ is always the worst possible outcome in TTC (trivial cycle)